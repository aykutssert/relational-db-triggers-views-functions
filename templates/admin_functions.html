<!-- templates/admin_functions.html -->
{% extends "base.html" %}
{% block title %}Database Functions{% endblock %}
{% block content %}
<h1>Database Functions</h1>

<div class="card" style="background: #e8f5e8; margin-bottom: 20px;">
    <h3>⚙️ 5 Farklı Database Function</h3>
    <p>Aşağıdaki function'lar database'de tanımlanmış ve gerçek zamanlı olarak çalışır. Her birini test edebilir ve sonuçlarını görebilirsiniz.</p>
</div>

<div class="grid">
    <div class="card">
        <h3>🔢 Function 1: Kitap Stok Sorgulama</h3>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
            <code>get_book_stock(book_id)</code>
        </div>
        <p><strong>Varsayılan Test (Kitap ID: 1):</strong></p>
        <p style="background: #e3f2fd; padding: 10px; border-radius: 4px; font-size: 18px;">
            <strong>{{ functions_data.book_stock }} adet</strong>
        </p>
        
        <form method="POST" action="{{ url_for('test_function') }}">
            <input type="hidden" name="function_name" value="get_book_stock">
            <div class="form-group">
                <label>Kitap ID:</label>
                <input type="number" name="param" value="1" min="1">
            </div>
            <button type="submit" class="btn btn-info">🔍 Test Et</button>
        </form>
    </div>

    <div class="card">
        <h3>💰 Function 2: Sipariş Toplam Hesaplama</h3>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
            <code>calculate_order_total(order_id)</code>
        </div>
        <p><strong>Varsayılan Test (Sipariş ID: 1):</strong></p>
        <p style="background: #e8f5e8; padding: 10px; border-radius: 4px; font-size: 18px;">
            <strong>{{ functions_data.order_total }} TL</strong>
        </p>
        
        <form method="POST" action="{{ url_for('test_function') }}">
            <input type="hidden" name="function_name" value="calculate_order_total">
            <div class="form-group">
                <label>Sipariş ID:</label>
                <input type="number" name="param" value="1" min="1">
            </div>
            <button type="submit" class="btn btn-info">💰 Test Et</button>
        </form>
    </div>

    <div class="card">
        <h3>📚 Function 3: Kategoriye Göre Kitaplar</h3>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
            <code>get_books_by_category(category_name)</code>
        </div>
        <p><strong>Varsayılan Test (Kategori: Roman):</strong></p>
        <div style="background: #fff3e0; padding: 10px; border-radius: 4px; max-height: 100px; overflow-y: auto;">
            <strong>{{ functions_data.books_by_category }}</strong>
        </div>
        
        <form method="POST" action="{{ url_for('test_function') }}">
            <input type="hidden" name="function_name" value="get_books_by_category">
            <div class="form-group">
                <label>Kategori Adı:</label>
                <select name="param">
                    <option value="Roman">Roman</option>
                    <option value="Bilim">Bilim</option>
                    <option value="Tarih">Tarih</option>
                    <option value="Felsefe">Felsefe</option>
                    <option value="Çocuk">Çocuk</option>
                    <option value="Teknoloji">Teknoloji</option>
                </select>
            </div>
            <button type="submit" class="btn btn-info">📚 Test Et</button>
        </form>
    </div>

    <div class="card">
        <h3>✍️ Function 4: Yazarın Kitap Sayısı</h3>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
            <code>get_author_book_count(author_id)</code>
        </div>
        <p><strong>Varsayılan Test (Yazar ID: 1 - Orhan Pamuk):</strong></p>
        <p style="background: #ffebee; padding: 10px; border-radius: 4px; font-size: 18px;">
            <strong>{{ functions_data.author_book_count }} kitap</strong>
        </p>
        
        <form method="POST" action="{{ url_for('test_function') }}">
            <input type="hidden" name="function_name" value="get_author_book_count">
            <div class="form-group">
                <label>Yazar ID:</label>
                <input type="number" name="param" value="1" min="1">
                <small style="color: #666; display: block;">1:Orhan Pamuk, 2:Sabahattin Ali, 3:Nazım Hikmet...</small>
            </div>
            <button type="submit" class="btn btn-info">✍️ Test Et</button>
        </form>
    </div>

    <div class="card">
        <h3>📊 Function 5: Ortalama Sipariş Değeri</h3>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
            <code>get_average_completed_order_value()</code>
        </div>
        <p><strong>Tamamlanmış Siparişlerin Ortalaması:</strong></p>
        <p style="background: #e8f5e8; padding: 10px; border-radius: 4px; font-size: 18px;">
            <strong>{{ functions_data.avg_order_value }} TL</strong>
        </p>
        
        <form method="POST" action="{{ url_for('test_function') }}">
            <input type="hidden" name="function_name" value="get_average_completed_order_value">
            <button type="submit" class="btn btn-info">📊 Yeniden Hesapla</button>
        </form>
        <small style="color: #666;">Bu function parametresiz çalışır ve completed durumundaki tüm siparişlerin ortalamasını alır.</small>
    </div>
</div>

<div class="card" style="background: #e3f2fd; margin-top: 30px;">
    <h4>🔧 Function'lar Hakkında Teknik Bilgi</h4>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
        <div>
            <h5>⚙️ Function Özellikleri:</h5>
            <ul style="padding-left: 20px;">
                <li><strong>Stok Kontrolü:</strong> Sipariş vermeden önce</li>
                <li><strong>Fiyat Hesaplama:</strong> Toplam tutarları hesapla</li>
                <li><strong>Raporlama:</strong> Kategori bazlı listeler</li>
                <li><strong>İstatistik:</strong> Yazar performansı</li>
                <li><strong>Analiz:</strong> Ortalama değerler</li>
            </ul>
        </div>
    </div>
</div>

<div class="card" style="background: #fff3e0;">
    <h4>🎯 Function Test Rehberi</h4>
    <p>Function'ları test etmek için:</p>
    <ol style="padding-left: 20px; margin: 10px 0;">
        <li><strong>Mevcut ID'leri kullanın:</strong> Kitap ID'leri 1-10, Sipariş ID'leri 1-5 arası</li>
        <li><strong>Farklı parametreler deneyin:</strong> Sonuçların nasıl değiştiğini gözlemleyin</li>
        <li><strong>Null değerleri test edin:</strong> Olmayan ID'ler için 0 döner</li>
        <li><strong>Gerçek zamanlı:</strong> Sipariş verdiğinizde ortalamalar güncellenir</li>
    </ol>
</div>
{% endblock %}