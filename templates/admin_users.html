<!-- templates/admin_users.html -->
{% extends "base.html" %}
{% block title %}KullanÄ±cÄ± YÃ¶netimi{% endblock %}
{% block content %}
<h1>KullanÄ±cÄ± YÃ¶netimi</h1>

<div class="tabs">
    <div class="tab active" onclick="showTab('users-list')">ğŸ‘¥ KullanÄ±cÄ± Listesi</div>
    <div class="tab" onclick="showTab('add-user')">â• KullanÄ±cÄ± Ekle</div>
</div>

<div id="users-list" class="tab-content active">
    <h2>KayÄ±tlÄ± KullanÄ±cÄ±lar</h2>
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Email</th>
                <th>Ad Soyad</th>
                <th>Tip</th>
                <th>KayÄ±t Tarihi</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.user_id }}</td>
                <td>{{ user.email }}</td>
                <td><strong>{{ user.first_name }} {{ user.last_name }}</strong></td>
                <td>
                    {% if user.user_type == 'admin' %}
                        <span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">ğŸ”‘ ADMIN</span>
                    {% else %}
                        <span style="background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">ğŸ‘¤ MÃœÅTERÄ°</span>
                    {% endif %}
                </td>
                <td>{{ user.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="card" style="background: #e8f5e8;">
        <h4>ğŸ“Š KullanÄ±cÄ± Ä°statistikleri</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 15px;">
            <div style="text-align: center; padding: 15px; background: white; border-radius: 8px;">
                <h3 style="color: #4CAF50;">{{ users|selectattr("user_type", "equalto", "customer")|list|length }}</h3>
                <p>Toplam MÃ¼ÅŸteri</p>
            </div>
            <div style="text-align: center; padding: 15px; background: white; border-radius: 8px;">
                <h3 style="color: #f44336;">{{ users|selectattr("user_type", "equalto", "admin")|list|length }}</h3>
                <p>Toplam Admin</p>
            </div>
            <div style="text-align: center; padding: 15px; background: white; border-radius: 8px;">
                <h3 style="color: #2196F3;">{{ users|length }}</h3>
                <p>Toplam KullanÄ±cÄ±</p>
            </div>
        </div>
    </div>
</div>

<div id="add-user" class="tab-content">
    <h2>Yeni KullanÄ±cÄ± Ekle</h2>
    <div class="card">
        <form method="POST" action="{{ url_for('add_user') }}">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="form-group">
                    <label>Email: *</label>
                    <input type="email" name="email" required placeholder="kullanici@email.com">
                </div>
                <div class="form-group">
                    <label>Åifre: *</label>
                    <input type="password" name="password" required placeholder="GÃ¼venli ÅŸifre girin">
                </div>
                <div class="form-group">
                    <label>Ad: *</label>
                    <input type="text" name="first_name" required placeholder="AdÄ±">
                </div>
                <div class="form-group">
                    <label>Soyad: *</label>
                    <input type="text" name="last_name" required placeholder="SoyadÄ±">
                </div>
            </div>
            <div class="form-group">
                <label>KullanÄ±cÄ± Tipi: *</label>
                <select name="user_type" required>
                    <option value="">Tip seÃ§in</option>
                    <option value="customer">ğŸ‘¤ MÃ¼ÅŸteri</option>
                    <option value="admin">ğŸ”‘ Admin</option>
                </select>
            </div>
            <button type="submit" class="btn">ğŸ‘¥ KullanÄ±cÄ± Ekle (Trigger Ã‡alÄ±ÅŸacak!)</button>
        </form>
    </div>
    
    <div class="card" style="background: #e3f2fd;">
        <h4>ğŸ’¡ KullanÄ±cÄ± Ekleme Trigger'Ä±</h4>
        <p>Yeni kullanÄ±cÄ± eklediÄŸinizde <strong>user_insert_log</strong> trigger'Ä± Ã§alÄ±ÅŸacak ve iÅŸlem system_logs tablosuna kaydedilecek. Triggers sekmesinden bu kaydÄ± gÃ¶rebilirsiniz.</p>
    </div>
    
    <div class="card" style="background: #fff3e0;">
        <h4>âš ï¸ Ã–nemli Notlar</h4>
        <ul style="padding-left: 20px; margin: 10px 0;">
            <li>Email adresleri benzersiz olmalÄ±dÄ±r</li>
            <li>Admin kullanÄ±cÄ±larÄ± tÃ¼m panellere eriÅŸebilir</li>
            <li>MÃ¼ÅŸteri kullanÄ±cÄ±larÄ± sadece kitap gÃ¶rÃ¼ntÃ¼leme ve sipariÅŸ verme iÅŸlemlerini yapabilir</li>
            <li>Sistem register sayfasÄ± olmadÄ±ÄŸÄ± iÃ§in yeni kullanÄ±cÄ±lar sadece admin tarafÄ±ndan eklenebilir</li>
        </ul>
    </div>
</div>
{% endblock %}